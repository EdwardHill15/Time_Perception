<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Edward F. Hillenaar">
<meta name="dcterms.date" content="2025-02-26">

<title>Simulated Effects of Temperature, Amphetamine, and LSD on Time Perception: An In Silico Investigation</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/quarto.js"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="index_files/libs/quarto-html/anchor.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting-dark-8ea72dc5fed832574809a9c94082fbbb.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="index_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="index_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="index_files/libs/bootstrap/bootstrap-207e17f1a70ca2c9891d2c9981023b9d.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="dark">


<link rel="stylesheet" href="styles.css">
</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Simulated Effects of Temperature, Amphetamine, and LSD on Time Perception: An In Silico Investigation</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Edward F. Hillenaar </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 26, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="time.png" class="img-fluid figure-img"></p>
<figcaption>Source: Image created by Edward F. Hillenaar with https://www.canva.com/ai-image-generator/</figcaption>
</figure>
</div>
<section id="abstract" class="level2">
<h2 class="anchored" data-anchor-id="abstract"><strong>Abstract</strong></h2>
<p>This study utilizes computational simulations to investigate the effects of temperature, amphetamine, and LSD on time perception. The Arrhenius equation models the influence of temperature on metabolic rate and perceived time. Simulated experiments explore amphetamine’s effects on subjective time estimation and LSD’s impact across varying microdoses. Results suggest complex interactions between physiological factors, pharmacological agents, and the subjective experience of time. The findings offer a theoretical framework for understanding altered time perception and emphasize the need for empirical validation.</p>
<p><strong><em>Keywords</em></strong>: Time Perception, Arrhenius Equation, Amphetamine, LSD, Simulation, Temperature, Metabolic Rate</p>
</section>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction"><strong>Introduction</strong></h2>
<p>Time perception is a complex cognitive process influenced by a variety of factors, including physiological state, pharmacological agents, and environmental conditions <span class="citation" data-cites="Wittmann2007">(<a href="#ref-Wittmann2007" role="doc-biblioref">Wittmann et al. 2007</a>)</span>. This study employs computational modeling to explore several potential influences on time perception, specifically focusing on the effects of temperature (as mediated through metabolic rate), amphetamine, and LSD. Simulations offer a valuable tool for generating testable hypotheses and exploring complex interactions in a controlled environment.</p>
</section>
<section id="methods" class="level2">
<h2 class="anchored" data-anchor-id="methods"><strong>Methods</strong></h2>
<section id="arrhenius-equation-simulation" class="level3">
<h3 class="anchored" data-anchor-id="arrhenius-equation-simulation"><strong><em>Arrhenius Equation Simulation</em></strong>:</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define constants</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fl">1e12</span>  <span class="co"># Pre-exponential factor (arbitrary units)</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="fl">8.314</span>  <span class="co"># Universal gas constant (J/(mol·K))</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>Ea <span class="ot">&lt;-</span> <span class="dv">50000</span>  <span class="co"># Activation energy (J/mol)</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to calculate reaction rate based on Arrhenius equation</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>arrhenius_rate <span class="ot">&lt;-</span> <span class="cf">function</span>(T) {</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  A <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>Ea <span class="sc">/</span> (R <span class="sc">*</span> T))</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to simulate perceived time based on metabolic rate</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>perceived_time <span class="ot">&lt;-</span> <span class="cf">function</span>(actual_time, metabolic_rate) {</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  actual_time <span class="sc">/</span> metabolic_rate</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate data</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>temperatures <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">273</span>, <span class="dv">313</span>, <span class="at">by =</span> <span class="dv">1</span>)  <span class="co"># 0°C to 40°C in Kelvin</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>metabolic_rates <span class="ot">&lt;-</span> <span class="fu">arrhenius_rate</span>(temperatures)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>actual_time <span class="ot">&lt;-</span> <span class="dv">60</span>  <span class="co"># 60 seconds</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate perceived time for each temperature</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>perceived_times <span class="ot">&lt;-</span> <span class="fu">perceived_time</span>(actual_time, metabolic_rates <span class="sc">/</span> <span class="fu">max</span>(metabolic_rates))</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">Temperature =</span> temperatures <span class="sc">-</span> <span class="dv">273</span>,  <span class="co"># Convert to Celsius for plotting</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">Metabolic_Rate =</span> metabolic_rates,</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">Perceived_Time =</span> perceived_times</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The Arrhenius equation was used to model the effect of temperature on metabolic rate and, subsequently, on perceived time. A range of temperatures (0-40°C) was simulated. Perceived time was modeled as inversely proportional to the normalized metabolic rate.</p>
<p>In this model:</p>
<ul>
<li><p>As temperature increases, metabolic rate increases (following the Arrhenius equation).</p></li>
<li><p>Perceived time is modeled as inversely proportional to metabolic rate (faster metabolism = slower perceived time passage).</p></li>
</ul>
<p>The resulting plot will show how metabolic rate increases with temperature, while perceived time for a fixed actual time decreases. This illustrates the concept that higher temperatures could lead to faster metabolic processes, potentially making time seem to pass more slowly.</p>
<p>Note that this is a simplified model and real biological systems are much more complex. The actual relationship between temperature, metabolic rate, and time perception in humans is not fully understood and would involve many more factors.</p>
</section>
<section id="amphetamine-experiment-simulation" class="level3">
<h3 class="anchored" data-anchor-id="amphetamine-experiment-simulation"><strong><em>Amphetamine Experiment Simulation</em></strong>:</h3>
<p>A simulated experiment was conducted with two conditions: Placebo and Amphetamine. Sixty simulated subjects were divided equally between the two conditions. Participants “estimated” time intervals of 2, 4, 6, 8, and 10 seconds, with five trials per interval. Amphetamine was modeled as increasing perceived duration (drug_effect = 1.2), and a small increase in variability was included (noise_level = 0.6).</p>
<p>This simulation provides a framework for understanding how amphetamines might affect time perception, but it’s important to note that real-world effects can be more complex and vary based on dosage, individual differences, and specific experimental conditions.</p>
</section>
<section id="lsd-experiment-simulation" class="level3">
<h3 class="anchored" data-anchor-id="lsd-experiment-simulation"><strong><em>LSD Experiment Simulation</em></strong>:</h3>
<p>A simulated experiment was conducted with four conditions: Placebo, LSD 5ug, LSD 10ug, and LSD 20ug. Sixty simulated subjects were divided equally among the four conditions. Participants “estimated” time intervals of 0.8, 1.6, 2, 3, and 4 seconds, with five trials per interval. LSD was modeled as increasing perceived duration in a dose-dependent manner (drug_effects = c(1, 1.05, 1.1, 1.15)), with a corresponding increase in variability (noise_levels = c(0.1, 0.12, 0.15, 0.18)).</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set seed for reproducibility</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Set seed for reproducibility</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to simulate time perception</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>simulate_time_perception <span class="ot">&lt;-</span> <span class="cf">function</span>(actual_time, drug_effect, noise) {</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  perceived_time <span class="ot">&lt;-</span> actual_time <span class="sc">*</span> drug_effect <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> noise)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">max</span>(perceived_time, <span class="dv">0</span>))  <span class="co"># Ensure non-negative time</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Experiment parameters</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>n_subjects <span class="ot">&lt;-</span> <span class="dv">60</span>  <span class="co"># Total number of subjects</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>actual_times <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">1.6</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)  <span class="co"># Actual time intervals to estimate in seconds</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>trials_per_time <span class="ot">&lt;-</span> <span class="dv">5</span>  <span class="co"># Number of trials for each time interval</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="co"># LSD conditions</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>conditions <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Placebo"</span>, <span class="st">"LSD_5ug"</span>, <span class="st">"LSD_10ug"</span>, <span class="st">"LSD_20ug"</span>)</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>drug_effects <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1.05</span>, <span class="fl">1.1</span>, <span class="fl">1.15</span>)  <span class="co"># Increasing effect with dose</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>noise_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.12</span>, <span class="fl">0.15</span>, <span class="fl">0.18</span>)  <span class="co"># Increasing variability with dose</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate experiment</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>simulate_condition <span class="ot">&lt;-</span> <span class="cf">function</span>(n, effect, noise) {</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>  results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (subject <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (time <span class="cf">in</span> actual_times) {</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (trial <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>trials_per_time) {</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>        perceived <span class="ot">&lt;-</span> <span class="fu">simulate_time_perception</span>(time, effect, noise)</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>        results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(results, <span class="fu">data.frame</span>(<span class="at">Subject =</span> subject, </span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">ActualTime =</span> time, </span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">PerceivedTime =</span> perceived))</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(results)</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>all_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(conditions)) {</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>  condition_data <span class="ot">&lt;-</span> <span class="fu">simulate_condition</span>(n_subjects<span class="sc">/</span><span class="dv">4</span>, drug_effects[i], noise_levels[i])</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>  condition_data<span class="sc">$</span>Condition <span class="ot">&lt;-</span> conditions[i]</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>  all_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(all_data, condition_data)</span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate mean perceived time for each actual time and condition</span></span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>summary_data <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(PerceivedTime <span class="sc">~</span> ActualTime <span class="sc">+</span> Condition, <span class="at">data =</span> all_data, <span class="at">FUN =</span> mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="analysis" class="level2">
<h2 class="anchored" data-anchor-id="analysis">Analysis</h2>
<p>For the Arrhenius equation simulation, a plot was generated to visualize the relationship between temperature, metabolic rate, and perceived time (Figure 1). For the amphetamine and LSD experiments, summary statistics were calculated, and plots were generated to compare perceived time across conditions (Figures 2 and 4). ANOVA analyses were performed to statistically evaluate the differences between groups using the <code>R ggstatsplot package</code>(Figure 3).</p>
</section>
<section id="results" class="level2">
<h2 class="anchored" data-anchor-id="results"><strong>Results</strong></h2>
<p><strong><em>Arrhenius Equation Simulation</em></strong>:</p>
<p>The simulation demonstrated an inverse relationship between temperature and perceived time. As temperature increased, the simulated metabolic rate increased, and perceived time decreased, representing a subjective speeding up of time (Figure 1).</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> Temperature)) <span class="sc">+</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Metabolic_Rate <span class="sc">/</span> <span class="fu">max</span>(Metabolic_Rate), <span class="at">color =</span> <span class="st">"Normalized Metabolic Rate"</span>)) <span class="sc">+</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Perceived_Time <span class="sc">/</span> <span class="fu">max</span>(Perceived_Time), <span class="at">color =</span> <span class="st">"Normalized Perceived Time"</span>)) <span class="sc">+</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Effect of Temperature on Metabolic Rate and Time Perception"</span>,</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Temperature (°C)"</span>,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Normalized Value"</span>,</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Measure"</span>) <span class="sc">+</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Normalized Metabolic Rate"</span> <span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"Normalized Perceived Time"</span> <span class="ot">=</span> <span class="st">"red"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-arrhenius-equation" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Plot of the Arrhenius Equation. ">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-arrhenius-equation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-arrhenius-equation-1.png" class="img-fluid figure-img" alt="Plot of the Arrhenius Equation. " width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-arrhenius-equation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Plot of the Arrhenius Equation showing the relationship between temperature, metabolic rate, and perceived time.
</figcaption>
</figure>
</div>
</div>
</div>
<p><strong><em>Amphetamine Experiment Simulation</em></strong>:</p>
<p>The amphetamine condition resulted in a systematic overestimation of time intervals compared to the placebo condition (Figure 2). Statistical analysis revealed a significant effect of amphetamine on perceived time (Figure 3).</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot results</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(summary_data, <span class="fu">aes</span>(<span class="at">x =</span> ActualTime, <span class="at">y =</span> PerceivedTime, <span class="at">color =</span> Condition)) <span class="sc">+</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Effect of Amphetamine on Time Perception"</span>,</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Actual Time (seconds)"</span>,</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Perceived Time (seconds)"</span>) <span class="sc">+</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-amphetamine-time" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Simulated Experiment Amphetamine and Time Perception. ">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-amphetamine-time-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-amphetamine-time-1.png" class="img-fluid figure-img" alt="Simulated Experiment Amphetamine and Time Perception. " width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-amphetamine-time-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Results Plot of a simulated experiment of the effect of usage Amphetamine on time perception.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-ANOVA-amphetamine" class="quarto-float quarto-figure quarto-figure-center anchored" alt="ANOVA statistics for Perceived and Metric Time. ">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ANOVA-amphetamine-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-ANOVA-amphetamine-1.png" class="img-fluid figure-img" alt="ANOVA statistics for Perceived and Metric Time. " width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ANOVA-amphetamine-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: ANOVA statistics for Perceived and Metric Time.
</figcaption>
</figure>
</div>
</div>
</div>
<p><strong><em>LSD Experiment Simulation</em></strong>:</p>
<p>The LSD simulation demonstrated a dose-dependent effect on perceived time. As the LSD dose increased, the perceived time increased, indicating a subjective slowing down of time (Figure 4).</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(summary_data, <span class="fu">aes</span>(<span class="at">x =</span> ActualTime, <span class="at">y =</span> PerceivedTime, <span class="at">color =</span> Condition)) <span class="sc">+</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Effect of LSD Microdoses on Time Perception"</span>,</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Actual Time (seconds)"</span>,</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Perceived Time (seconds)"</span>) <span class="sc">+</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-LSD-time" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Simulated Experiment LSD and Time Perception. ">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-LSD-time-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-LSD-time-1.png" class="img-fluid figure-img" alt="Simulated Experiment LSD and Time Perception. " width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-LSD-time-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Simulated Experiment LSD and Time Perception.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="discussion" class="level1">
<h1><strong>Discussion</strong></h1>
<p>The simulations presented here provide a theoretical framework for understanding the complex interplay of factors influencing time perception. The Arrhenius equation simulation highlights the potential role of physiological factors, such as metabolic rate, in shaping our subjective experience of time (Figure 1). The amphetamine simulation demonstrates how pharmacological agents affecting dopamine systems can alter temporal estimation (Figure 2). The LSD simulation supports findings that even microdoses can influence time perception, potentially via serotonin system modulation <span class="citation" data-cites="Yanakieva2019">(<a href="#ref-Yanakieva2019" role="doc-biblioref">Yanakieva et al. 2019</a>)</span> (Figure 4). The ANOVA statistics can be observed in figure 3.</p>
<p>Limitations of this study include its reliance on simulated data and simplified models. Future research should focus on empirically validating these findings in human participants and exploring the underlying neural mechanisms involved in these effects. Further work should examine the REBUS model further <span class="citation" data-cites="Carhart-Harris2019">(<a href="#ref-Carhart-Harris2019" role="doc-biblioref">Carhart-Harris and Friston 2019</a>)</span>.</p>
</section>
<section id="conclusion" class="level1">
<h1><strong>Conclusion</strong></h1>
<p>This in silico study suggests that time perception is a dynamic process influenced by temperature, metabolic rate, and pharmacological agents. While these simulations provide valuable insights, empirical research is crucial for validating these findings and further elucidating the neural mechanisms underlying subjective time experience.</p>
</section>
<section id="references" class="level1 unnumbered">


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-Block1997" class="csl-entry" role="listitem">
Block, Richard A., and Dan Zakay. 1997. <span>“<span class="nocase">Prospective and retrospective duration judgments: A meta-analytic review</span>.”</span> <em>Psychonomic Bulletin and Review</em> 4 (2): 184–97. <a href="https://doi.org/10.3758/BF03209393">https://doi.org/10.3758/BF03209393</a>.
</div>
<div id="ref-Carhart-Harris2019" class="csl-entry" role="listitem">
Carhart-Harris, R. L., and K. J. Friston. 2019. <span>“<span class="nocase">REBUS and the anarchic brain: Toward a unified model of the brain action of psychedelics</span>.”</span> <em>Pharmacological Reviews</em> 71 (3): 316–44. <a href="https://doi.org/10.1124/pr.118.017160">https://doi.org/10.1124/pr.118.017160</a>.
</div>
<div id="ref-Hancock1993" class="csl-entry" role="listitem">
Hancock, P. A. 1993. <span>“<span class="nocase">Body temperature influence on time perception</span>.”</span> <em>Journal of General Psychology</em> 120 (3): 197–216. <a href="https://doi.org/10.1080/00221309.1993.9711144">https://doi.org/10.1080/00221309.1993.9711144</a>.
</div>
<div id="ref-Hendricks2019" class="csl-entry" role="listitem">
Hendricks, Scotty. 2019. <span>“<span class="nocase">Microdoses of LSD change how you perceive time</span>.”</span> <a href="https://bigthink.com/neuropsych/lsd-micrdose-time/">https://bigthink.com/neuropsych/lsd-micrdose-time/</a>.
</div>
<div id="ref-Krystal2005" class="csl-entry" role="listitem">
Krystal, John H., Edward B. Perry, Ralitza Gueorguieva, Aysenil Belger, Steven H. Madonick, Anissa Abi-Dargham, Thomas B. Cooper, Lisa MacDougall, Walid Abi-Saab, and D. Cyril D’Souza. 2005. <span>“<span class="nocase">Comparative and Interactive Human Psychopharmacologic Effects of Ketamine and Amphetamine</span>.”</span> <em>Archives of General Psychiatry</em> 62 (9): 985. <a href="https://doi.org/10.1001/archpsyc.62.9.985">https://doi.org/10.1001/archpsyc.62.9.985</a>.
</div>
<div id="ref-Ogden2011" class="csl-entry" role="listitem">
Ogden, Ruth S., John H. Wearden, Denis T. Gallagher, and Catharine Montgomery. 2011. <span>“<span class="nocase">The effect of alcohol administration on human timing: A comparison of prospective timing, retrospective timing and passage of time judgements</span>.”</span> <em>Acta Psychologica</em> 138 (1): 254–62. <a href="https://doi.org/10.1016/j.actpsy.2011.07.002">https://doi.org/10.1016/j.actpsy.2011.07.002</a>.
</div>
<div id="ref-Sadibolova2023" class="csl-entry" role="listitem">
Sadibolova, Renata, Clare Murray-Lawson, Neiloufar Family, Luke T. J. Williams, David P. Luke, and Devin B. Terhune. 2023. <span>“<span class="nocase">LSD microdosing attenuates the impact of temporal priors in time perception.</span>”</span> <em>bioRxiv</em>, 2023.04.14.536983. <a href="https://www.biorxiv.org/content/10.1101/2023.04.14.536983v1%0Ahttps://www.biorxiv.org/content/10.1101/2023.04.14.536983v1.abstract">https://www.biorxiv.org/content/10.1101/2023.04.14.536983v1%0Ahttps://www.biorxiv.org/content/10.1101/2023.04.14.536983v1.abstract</a>.
</div>
<div id="ref-Stetson2007" class="csl-entry" role="listitem">
Stetson, Chess, Matthew P. Fiesta, and David M. Eagleman. 2007. <span>“<span class="nocase">Does time really slow down during a frightening event?</span>”</span> <em>PLoS ONE</em> 2 (12): 10–13. <a href="https://doi.org/10.1371/journal.pone.0001295">https://doi.org/10.1371/journal.pone.0001295</a>.
</div>
<div id="ref-Tamm2014" class="csl-entry" role="listitem">
Tamm, Maria, Ainika Jakobson, Merle Havik, Andres Burk, Saima Timpmann, Jüri Allik, Vahur Ööpik, and Kairi Kreegipuu. 2014. <span>“<span class="nocase">The compression of perceived time in a hot environment depends on physiological and psychological factors</span>.”</span> <em>Quarterly Journal of Experimental Psychology</em> 67 (1): 197–208. <a href="https://doi.org/10.1080/17470218.2013.804849">https://doi.org/10.1080/17470218.2013.804849</a>.
</div>
<div id="ref-Winterbauer2007" class="csl-entry" role="listitem">
Winterbauer, Neil E., and Bernard W. Balleine. 2007. <span>“<span class="nocase">The influence of amphetamine on sensory and conditioned reinforcement: Evidence for the re-selection hypothesis of dopamine function</span>.”</span> <em>Frontiers in Integrative Neuroscience</em> 1 (NOV): 1–8. <a href="https://doi.org/10.3389/neuro.07.009.2007">https://doi.org/10.3389/neuro.07.009.2007</a>.
</div>
<div id="ref-Wittmann2007" class="csl-entry" role="listitem">
Wittmann, Marc, David S. Leland, Jan Churan, and Martin P. Paulus. 2007. <span>“<span class="nocase">Impaired time perception and motor timing in stimulant-dependent subjects</span>.”</span> <em>Drug and Alcohol Dependence</em> 90 (2-3): 183–92. <a href="https://doi.org/10.1016/j.drugalcdep.2007.03.005">https://doi.org/10.1016/j.drugalcdep.2007.03.005</a>.
</div>
<div id="ref-Yanakieva2019" class="csl-entry" role="listitem">
Yanakieva, Steliana, Naya Polychroni, Neiloufar Family, Luke T. J. Williams, David P. Luke, and Devin B. Terhune. 2019. <span>“<span class="nocase">The effects of microdose LSD on time perception: a randomised, double-blind, placebo-controlled trial</span>.”</span> <em>Psychopharmacology</em> 236 (4): 1159–70. <a href="https://doi.org/10.1007/s00213-018-5119-x">https://doi.org/10.1007/s00213-018-5119-x</a>.
</div>
<div id="ref-Zhang2019" class="csl-entry" role="listitem">
Zhang, Mingming, Di Zhao, Zhao Zhang, Xinyu Cao, Lu Yin, Yi Liu, Ti Fei Yuan, and Wenbo Luo. 2019. <span>“<span class="nocase">Time perception deficits and its dose-dependent effect in methamphetamine dependents with short-term abstinence</span>.”</span> <em>Science Advances</em> 5 (10). <a href="https://doi.org/10.1126/sciadv.aax6916">https://doi.org/10.1126/sciadv.aax6916</a>.
</div>
<div id="ref-Zhang2020" class="csl-entry" role="listitem">
———. 2020. <span>“<span class="nocase">Commentary: Time perception deficits and its dose-dependent effect in methamphetamine dependents with short-term abstinence</span>.”</span> <em>Frontiers in Cellular Neuroscience</em> 14 (263): 1–4. <a href="https://doi.org/10.1126/sciadv.aax6916">https://doi.org/10.1126/sciadv.aax6916</a>.
</div>
</div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>